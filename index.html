<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/select/1.2.7/css/select.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/1.5.2/css/buttons.dataTables.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>SlowMoMan</title>
    <style>
        table.dataTable.compact {
            table-layout: fixed;
            word-wrap:break-word;
            word-break: break-all;
            font-size: 10pt;
        }
        table.dataTable.compact tbody>tr.odd.selected {
            background-color: #DDD;
        }
        table.dataTable.compact tbody>tr.even.selected {
            background-color: #DDD;
        }


        body, html{
            padding:0;
            margin:0;
            position:relative;
            height:100%;
            background: #FFFFFF;
            font-family: system-ui;
        }

        #main {
            min-height: 100%;
            position:relative;
        }

        .header {
            width:100%;
            height:80px;
            position: fixed;
            top: 0;
            box-sizing:border-box;
            box-shadow: 0 0 10px rgba(0,0,0,.05), 2px 2px 10px rgba(0,0,0,.1);
            background: linear-gradient(180deg, hsla(211, 100%, 41%, 1) 1%, hsla(213, 84%, 63%, 1) 100%);
        }

        #banner {
            margin-left: 20px;
        }

        .footer{
            width:100%;
            height:15px;
            position: fixed;
            bottom: 0;
            box-sizing:border-box;
            background: hsla(211, 100%, 47%, 1);
            font-size: x-small;
            font-palette: light;
        }

        .content{
            margin-top: 80px;
            display: flex;
            flex-direction: column;
        }

        .left{
            width:25%;
            margin-top: 88px;
            top: 0;
            bottom: 0;
            position: fixed;
            min-height: 0;
            display: block;
            overflow-y:scroll;
        }

        .right{
            width:calc(75% - 1px);
            margin-left: 25%;
            background:#fff;
            display: block;
            min-height: calc(100vh);
            overflow-y:scroll;
            align-content: center;
        }

        .canvas-container {
            padding-left: 0;
            padding-right: 0;
            margin-top: 15px;
            margin-left: auto;
            margin-right: auto;
            display: block
        }

        table {
            width: 100%;
        }

        .label_bar{
            border-radius: 15px 15px 0px 0px;
            background: #F18a00;
            width:90%;
            height: 30px;
            line-height: 30px;
            text-align: center;
            margin-top: 15px;
            box-shadow: 0 0 7px #c0c0c0;
            font-size: small;
        }

        .label_menu{
            width:90%;
            border-radius: 0px 0px 15px 15px;
            background-color: #ebebeb;
            box-shadow: 0 0 1px #ccc;
            padding-bottom:10px;
        }

        .transparent_button {
            background-color: transparent;
            border: 0px;
        }

        .button {
            background-color: #f18900; /* Green */
            border: none;
            color: black;
            padding: 7px 10px;
            text-align: center;
            display: inline-block;
            font-size: small;
            border-radius: 12px;
            font-family: system-ui;
            margin-top: 10px;
            font-weight: bold;
        }

        input {
            border:0;
            background:none;
            padding:0;
        }

        .slider {
            -webkit-appearance: none;
            width: 40%;
            height: 3px;
            border-radius: 10px;
            background: #fff;
            opacity: 0.7;
            -webkit-transition: .2s;
            transition: opacity .2s;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 5px;
            height: 10px;
            border-radius: 30%;
            background: #f18900;
            cursor: ew-resize;
        }

        td {
            overflow: visible;
            text-overflow: ellipsis;
            white-space: normal;
            text-align: center;
            vertical-align: middle;
            word-break: break-all;
        }


        div.dataTables_filter > label > input {
            font-size: 0.8em;
            border: 1px solid black;
            border-radius: 5px;
            align-self: center;
            margin-right: 235px;
            margin-bottom: 15px;
            margin-top: 15px;
        }

        .parent {
            display: -moz-flex;
            display: -ms-flexbox;
            display: -webkit-flex;
            display: flex;
            flex-direction: column;
            width: 9.5em;
            justify-content: space-evenly;
            font-size: x-small;
            border-radius: 5px 5px 5px 5px;
            background-color: #fafafa;
            box-shadow: 0 0 2px #ccc;
            font-family: "Andale Mono";
        }


    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-alpha1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/select/1.2.7/js/dataTables.select.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.flash.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.5.2/js/buttons.html5.min.js"></script>
    <script src="papaparse.min.js"></script>
    <script src="colorlist.js"></script>
    <script src="slowmoman_datatable.js"></script>
    <script src="fft.js"></script>
    <script src="main.js"></script>

</head>
<body onload="init()">
        <!-- header -->
        <div class="header">
            <div id="banner" style="display:flex; flex-direction: row; justify-content: left; align-items: center">
                <img src="images/graphics/SMM_Logo.svg" alt="SlowMoMan" height=80 width=auto />
                <button type="button" class="buttons-html5 transparent_button"><a href="index.html"><img src="images/graphics/Home.svg" height=40px></a></button>
                <button type="button" class="buttons-html5 transparent_button"><a href="quickstart.html"><img src="images/graphics/QuickStart.svg" height=40px></a></button>
                <button type="button" class="buttons-html5 transparent_button"><a href="usecases.html"><img src="images/graphics/UseCases.svg" height=40px></a></button>
                <button type="button" class="buttons-html5 transparent_button"><a href="about.html"><img src="images/graphics/About.svg" height=40px></a></button>
            </div>
        </div>

        <!-- main content
            TO DO:
            export image
            timing of loading data + timing of compute for FFT (per use case)
            autocorrelation lag metric is user accessible
            push code FRIDAY
            Next Tuesday meet again
        -->

        <div class="content">
            <!-- left scrolling column -->
            <div class="left" style="display:flex; flex-direction: column; align-items: center;  overflow-y: scroll; margin-bottom: 50px; flex: 0 0 1250px;">
                <!-- pre-loaded data -->
                <div class="label_bar"><strong>Pre-Loaded Data</strong></div>
                <div id="file_options" class="label_menu">
                    <div style="margin-left: 15px; margin-top:5px; font-size: small">
                    Choose a dataset to load:
                        <br>
                        <input type="radio" id="swiss" name="preload" value="swiss" checked>
                        <label for="swiss">Swiss roll dataset</label><br>
                        <input type="radio" id="fashion" name="preload" value="fashion">
                        <label for="fashion">Fashion MNIST dataset</label><br>
                        <input type="radio" id="microbiome" name="preload" value="microbiome">
                        <label for="microbiome">Human microbiome dataset</label>
                        <br>
                        <button class="buttons-html5 transparent_button button" id="submit_preload" onclick="preloadSubmitted()">Submit</button>
                    </div>
                </div>
                <!-- user uploaded data -->
                <div class="label_bar"><strong>Upload Your Data</strong></div>
                <div id="uploads" class="label_menu">
                    <!-- embedding upload -->
                    <div style="margin-left: 15px; margin-top:5px; font-size: small">Upload the 2D Embedding</div>
                    <input type="file" id="embeddingFileUpload" accept=".csv" style="margin-left:15px; margin-top: 10px;"/>
                    <progress id="embeddingProgress" value="0" style="margin-left:20px"> </progress>
                    <span id="embeddingProgressMessage" style="font-size: 85%; margin-left:5px"> </span>
                    <!-- high dim upload -->
                    <br>
                    <div style="margin-left: 15px; margin-top:5px; font-size: small">Upload the original space</div>
                    <input type="file" id="highDimFileUpload" accept=".csv" style="margin-left:15px; margin-top: 10px;"/>
                    <progress id="highDimProgress" value="0" style="margin-left:20px"> </progress>
                    <span id="highDimProgressMessage" style="font-size: 85%; margin-left:5px"> </span>
                </div>
                <!-- visual params -->
                <div class="label_bar"><strong>Visual Parameters</strong></div>
                <div id="vis_params" class="label_menu">
                    <div style="margin-left: 15px; margin-top: 5px; font-size: small;">
                    Point size: <input type="range" min="10" max="30" value="20" class="slider" id="point_size_slider">
                    <br>
                    Opacity: <input type="range" min="1" max="100" value="100" class="slider" id="opacity_slider">
                    <br>
                    Line Width: <input type="range" min="10" max="40" value="20" class="slider" id="line_width_slider">
                    </div>
                </div>
                <!-- fft params -->
                <div class="label_bar"><strong>FFT Metric</strong></div>
                <div id="fft_params" class="label_menu">
                    <div id="bin_num_container" style="margin-left: 15px; margin-top: 5px; font-size: small;">
                        Number of bins: <span id="bin_num"> 512 </span><br>
                        <input type="range" min="1" max="14" value="9" class="slider" id="bin_num_slider">
                    </div>
                    <button class="buttons-html5 transparent_button button" id="submit_fft" style="margin-left: 15px;">Compute</button>
                </div>
                <!-- autocorrelation params -->
                <div class="label_bar"><strong>Autocorrelation Metric</strong></div>
                <div id="autocorr_params" class="label_menu">
                    <div id="lag_container" style="margin-left: 15px; margin-top: 5px; font-size: small;">
                        Lag Parameter: <span id="lag_value"> 22 </span><br>
                        <input type="range" min="1" max="100" value="22" class="slider" id="lag_slider">
                    </div>
                    <div id="bin_num_container2" style="margin-left: 15px; margin-top: 10px; font-size: small;">
                        Number of bins: <span id="bin_num2"> 512 </span><br>
                        <input type="range" min="1" max="10000" value="512" class="slider" id="bin_num_slider2">
                    </div>
                    <button class="buttons-html5 transparent_button button" id="submit_autocorr" style="margin-left: 15px;">Compute</button>
                </div>
                <!-- variance params
                <div class="label_bar"><strong>Variance Metric</strong></div>
                <div id="variance_params" class="label_menu">
                </div>
                -->
                <br>
                <button class="buttons-html5 transparent_button button" id="reset" style="font-size: medium">Erase Line <i class="fa fa-eraser"></i></button>
            </div>


            <!-- right scrolling column -->
            <div class="right" style="display:flex; flex-direction: column; align-items: center; flex: 0 0 1400px;">
                <br><br>
                <div style="display:flex; flex-direction: row; justify-content: left">
                    <div>
                        <strong>Labels (if any)</strong>
                        <div id="descriptions" class="parent" style="height: 150px; overflow-y: scroll; overflow-x: scroll; word-break:break-word; margin-right: 7px; margin-top: 17px;">&nbsp;</div>
                        Hold "shift"<br>to draw<br>trajectory.
                    </div>
                <div id="container" style="display:flex; flex-direction: row; justify-content: left">
                    <!-- color pickers -->
                        <div id="draw_sidebar" style="display:flex; flex-direction: column; justify-content: left">
                        <div id="colors_holder" style="margin-left: 15px; margin-top:10px; font-size: small; align-content: center;">
                            <strong>Class colors:</strong>
                        </div>
                        <div id="load_path" style="margin-left: 15px;">
                            <span id="import_path" class="button"> &#8634; Import path</span>
                            <span id="export_path" class="button"> &#x270E; Export path</span>
                        </div>
                        <div style="margin-left: 15px;">
                            <span id="save_svg" class="button" > &#128247; Save Plot</span>
                        </div>
                    </div>
                </div> </div>
                <br><br>
                <div><strong>Results</strong></div>
                <div class="canvas-container" style="display:flex; flex-direction: row; justify-content: left;">
                    <div style="width: 500px; float: left; ">
                        <table id="variables" class="compact" style="width:100%; background-color: #f18900;" title="Use shift and control to select multiple rows">
                            <thead>
                            <tr>
                                <th>Label</th>
                                <th>Color</th>
                                <th>Variable</th>
                                <th title="Metric Score">Score</th>
                            </tr>
                            </thead>
                            <tbody id="variable_body">
                            </tbody>
                        </table>
                    </div>
                    <div style="margin-left: 5px;">
                        <svg id="svg2" class="svg2" width="535" height="530" style="background-color: #f7f7f7"></svg>
                    </div>

                    <br />
                </div>
            </div>
        </div>
</body>
<!-- footer -->
<div class="footer">
    <div class="banner">
        Copyright Â© 2024 Yun William Yu. All rights reserved.
    </div>
</div>
</html>
